@return 0 on success, nonzero value on error