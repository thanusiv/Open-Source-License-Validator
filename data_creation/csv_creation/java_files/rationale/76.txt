Caller of this method must hold that lock.