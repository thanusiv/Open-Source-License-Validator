/**
   * Check that a state tansition is valid and
   * throw an exception if not