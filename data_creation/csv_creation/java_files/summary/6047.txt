    // synchronized so that checkState works as expected.