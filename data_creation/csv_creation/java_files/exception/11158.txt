 @throws IllegalStateException
     *             if not processing a request of the correct type